<!DOCTYPE html><html><head><title>Vue3 ç¬¬äºŒæ¬¡ä½œæ¥­ - é£²æ–™é»å–®ç³»çµ±</title><meta name="viewport" content="width=device-width, initial-scale=1"><link href="images/favicon.ico" rel="shortcut icon"><meta charset="UTF-8"><script src="./javascripts/vendor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.0.2/vue.global.js"></script></head><body class="bg-lighter">
<div class="container main my-3"><div class="row"><main class="col post">
<!-- ç« ç¯€æ¨™é¡Œ --><div class="mb-4"><h1 class="mt-0 text-muted">Vue3 ç¬¬äºŒæ¬¡ä½œæ¥­ - é£²æ–™é»å–®ç³»çµ±</h1></div>
<!-- ğŸ”¥ğŸ”¥ç·´ç¿’é–‹å§‹ğŸ”¥ğŸ”¥ -->

<div id="app">
  <div class="container gx-2">
    <div class="row gx-3 bg-light py-2">
      <div class="col-lg-3 mb-md-2" style="height: 591px; overflow-y: scroll;">
        <div class="d-flex flex-column" style="gap: 0.5rem;">
          <div class="list-group" v-for="item in products">
            <a href="#" class="list-group-item list-group-item-action" @click="selectDrinks(item)" style="padding: 8px;">
              <div class="d-flex" style="gap: 8px;">
                <div>
                  <img :src="item.imageUrl" style="width: 85px; height: 85px; object-fit: cover; ">
                </div>
                <div class="d-flex flex-column" style="width: 100%; height: 100%;">
                  <h6 class="card-title mb-0"> {{ item.name }} </h6>
                  <p class="mb-0"><small> {{ item.engName }} </small></p>
                  <p class="mb-0 mt-1 text-end"><small>NT$  {{ item.price }} </small></p>
                </div>
              </div>
              
            </a>
          </div>
        </div>
        
      </div>
      <div class="col-lg-9">
        <div class="card mb-2">
          <div class="position-absolute text-white d-flex align-items-center justify-content-center" style="top: 0;bottom: 0;left: 0;right: 0;background-color: rgba(0, 0, 0, 0.65); z-index: 100;" v-if="darkZone">è«‹å…ˆé¸æ“‡é£²å“</div>
          <div class="card-body px-4">
            <div class="mb-3">
              <div class="d-flex" style="gap: 20px;">
                <div>
                  <img :src="temp.imageUrl" alt="" style="width: 85px; height: 85px; object-fit: cover; ">
                  
                </div>
                <div>
                  <h4> {{ temp.name }} </h4>
                  <small> {{ temp.engName }} </small>
                </div>
              </div>
              
            </div>
            <div class="mb-3">
              <label for="productNum" class="form-label">æ•¸é‡</label>
              <input type="number" class="form-control" id="productNum" placeholder="æ•¸é‡" min="1" step="1" onkeyup="value=value.replace(/[^\d]/g,'').replace(/^0{1,}/g,'')" :value="temp.number" v-model.number="temp.number">
            </div>
            <div class="mb-3">
              <label for="productNum" class="form-label d-block">å†°å¡Š*</label>
              <div class="form-check form-check-inline" v-for="(ice, key) in iceType" :key=" 'ice' + key">
                <input class="form-check-input" name="iceType" type="radio" :id="ice" :value="ice" v-model="temp.ice" :disabled="temp.ice == temp.defaultIce">
                <label class="form-check-label" :for="ice"> {{ ice }} </label>
              </div>
            </div>
            <div class="mb-3">
              <label for="productNum" class="form-label d-block">ç”œåº¦*</label>
              <div class="form-check form-check-inline" v-for="(sugar, key) in sugarType" :key=" 'sugar' + key">
                <input class="form-check-input" name="sugarType" type="radio" :id="sugar" :value="sugar" v-model="temp.sugar" :disabled="temp.sugar == temp.defaultSugar">
                <label class="form-check-label" :for="sugar"> {{ sugar }} </label>
              </div>
            </div>
            <div class="mb-3">
              <label for="productNum" class="form-label d-block">åŠ æ–™</label>
              <div class="form-check form-check-inline" v-for="(toppings, key) in toppingsType" :key=" 'toppings' + key">
                <input class="form-check-input" type="checkbox" :id="toppings" :value="toppings" v-model="temp.toppings" :disabled="toppings == temp.defaultToppings">
                <label class="form-check-label" :for="toppings"> {{ toppings }} </label>
              </div>
            </div>
            <div class="mb-3">
              <label for="productNotice" class="form-label">å‚™è¨»</label>
              <textarea class="form-control" id="productNotice" rows="2" v-model="temp.note"></textarea>
            </div>
            <div class="d-flex gap-2">
              <button class="btn btn-outline-primary w-100 shadow-none" type="button" @click="cancelBtn">å–æ¶ˆ</button>
              <button class="btn btn-primary w-100 shadow-none" type="button" @click="submitBtn(temp)">ç¢ºèª</button>
            </div>
          </div>
        </div>
        
      </div>
      <div class="col-lg-12">
        <div class="card" v-if="hasOrder">
          <div class="card-body">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">å“é …</th>
                  <th scope="col">å†°å¡Š</th>
                  <th scope="col">ç”œåº¦</th>
                  <th scope="col">åŠ æ–™</th>
                  <th scope="col">å–®åƒ¹</th>
                  <th scope="col">æ•¸é‡</th>
                  <th scope="col">å°è¨ˆ</th>
                  <th scope="col">ä¿®æ”¹</th>
                  <th scope="col">åˆªé™¤</th>
                </tr>
              </thead>
              <tbody>
                <template v-for="(item, key) in orderList" :key=" 'item' + key ">
                  <tr>
                    <th scope="row"> {{ item.name }} <br>
                      <small class="text-muted fw-normal">å‚™è¨»ï¼š{{ item.note }}</small>
                    </th>
                    <td> {{ item.ice }} </td>
                    <td> {{ item.sugar }} </td>
                    <td> {{ item.toppings.join('ã€') }} </td>
                    <td> {{ item.salesPrice }} </td>
                    <td> {{ item.number }} </td>
                    <td> {{ item.sum }} </td>
                    <td><button type="button" class="btn btn-primary btn-sm" @click="modifyBtn(item)">ä¿®æ”¹</button></td>
                    <td><button type="button" class="btn btn-danger btn-sm" @click="deleteBtn(item)">åˆªé™¤</button></td>
                  </tr>
                </template>
              </tbody>
            </table>
            <p class="text-end">å…± {{ orderList.length }} ç­†ï¼Œ NT$ {{ orderTotal }} å…ƒ</p>
            <button type="button" class="btn btn-sm btn-secondary w-100 shadow-none" @click="generateOrder(orderList)">ç”¢ç”Ÿè¨‚å–®</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="bg-light p-3 mt-3" v-for="(history, i) in historyOrder" :key=" 'history' + i">
    <div class="bg-white p-3 d-flex flex-column" style="min-height: 300px;" v-if="orderDetail.length > 0">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">å“é …</th>
            <th scope="col">å†°å¡Š</th>
            <th scope="col">ç”œåº¦</th>
            <th scope="col">åŠ æ–™</th>
            <th scope="col">å–®åƒ¹</th>
            <th scope="col">æ•¸é‡</th>
            <th scope="col">å°è¨ˆ</th>
          </tr>
        </thead>
        <tbody>
          <!-- {{historyOrder[2]}} -->
          <template v-for="(item, key) in history.list" :key=" 'item' + key">
            <tr>
              <th scope="row"> {{ item.name }} <br>
                <small class="text-muted fw-normal">å‚™è¨»ï¼š{{ item.note }} </small>
              </th>
              <td> {{ item.ice }} </td>
              <td> {{ item.sugar }} </td>
              <td> {{ item.toppings.join('ã€') }} </td>
              <td> {{ item.salesPrice }} </td>
              <td> {{ item.number }} </td>
              <td> {{ item.sum }} </td>
            </tr>
          </template>
        </tbody>
      </table>
      <p class="mt-3 mb-1">è¨‚å–®æˆç«‹æ™‚é–“ï¼š {{ history.date }} </p>
      <p class="mb-1">é¤é»æ•¸ï¼š {{ history.setNumber }} </p>
      <p class="mb-1">ä»˜æ¬¾ç‹€æ…‹ï¼šæœªä»˜æ¬¾</p>
      <p class="text-end mt-auto">å…± NT$ {{ history.total }} å…ƒ</p>
    </div>
  </div>
</div>

<script>
const App = {
  data() {
    return {
      iceType: ['æ­£å¸¸å†°', 'å°‘å†°', 'å¾®å†°', 'å»å†°', 'ç†±'],
      sugarType: ['å…¨ç³–', 'ä¸ƒåˆ†', 'åŠç³–', 'ä¸‰åˆ†', 'ç„¡ç³–'],
      toppingsType: ['çç ', 'ç²‰æ¢', 'å°ç²‰åœ“', 'æ¤°æœ', 'èŠ‹é ­'],
      products: [
        {
          name: 'çç é®®å¥¶èŒ¶',
          engName: 'Pearl Milk Tea',
          price: 60,
          imageUrl: 'https://i2.wp.com/www.hiilan.com.tw/wp-content/uploads/2020/02/DSC_8373-scaled.jpg?ssl=1',
          defaults: {
            toppings: ['çç '],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'æ¤°æœé®®å¥¶èŒ¶',
          engName: 'Coconut Milk Tea',
          price: 60,
          imageUrl: 'https://img.alicdn.com/i3/3055821050/O1CN01ZrgtX51JcwUI0ugvJ_!!3055821050-0-lubanu-s.jpg',
          defaults: {
            toppings: ['æ¤°æœ'],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'é®®å¥¶èŒ¶',
          engName: 'Milk Tea',
          price: 50,
          imageUrl: 'https://assets.tmecosys.com/image/upload/t_web767x639/img/recipe/ras/Assets/14648198-fecf-41fc-b2d6-0f888bd69a68/Derivates/9ba109e7-c327-4828-b2d4-4eb973987cb8.jpg',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'å¤æ„å†¬ç“œèŒ¶ (ç³–å›ºå®š)',
          engName: 'Winter Melon Drink',
          price: 30,
          imageUrl: 'https://assets.tmecosys.com/image/upload/t_web767x639/img/recipe/ras/Assets/d807443b-56c0-474c-9a62-9dde2d5ca382/Derivates/3f7aad6a-7e0f-4082-ae76-bf2ef1110be3.jpg',
          defaults: {
            toppings: [''],
            sugar: 'å…¨ç³–',
            ice: '',
          }
        },
        {
          name: 'èœœé¦™ç´…èŒ¶',
          engName: 'Black Tea',
          price: 30,
          imageUrl: 'https://cf.shopee.tw/file/66ee0a430f5e9a8e7c5f5e8a394d6c50',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'åŒ…ç¨®é’èŒ¶',
          engName: 'Black Tea',
          price: 35,
          imageUrl: 'https://cf.shopee.tw/file/4fbb81da8041987fea2884a5053493b8',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'æª¸æª¬çƒé¾',
          engName: 'Lemon Oolong Tea',
          price: 55,
          imageUrl: 'https://d1ralsognjng37.cloudfront.net/6b07ef53-6110-4433-b155-84e95eaa39e1.jpeg',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'è–‘æ¯èŒ¶ (ç†±é£²)',
          engName: 'Ginger Tea',
          price: 55,
          imageUrl: 'https://i.beauty321.com/816x/https://il.beauty321.com/gallery/gallery/45043/photo-61a0619861312.jpg',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: 'ç†±',
          }
        },
        {
          name: 'é’è‰èŒ¶',
          engName: 'Herbal Tea',
          price: 35,
          imageUrl: 'https://cf.shopee.tw/file/dc3273d369b2591362d31e062e277e58',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'é‡‘æ¡”æª¸æª¬',
          engName: 'Kumquat Lemonade',
          price: 40,
          imageUrl: 'https://im.marieclaire.com.tw/m800c533h100b0/assets/mc/202005/5EBBC9F251EEB1589365234.jpeg',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: '',
          }
        },
        {
          name: 'æŸ³æ¾„é’èŒ¶',
          engName: 'Orange Mountain Tea',
          price: 45,
          imageUrl: 'https://i.beauty321.com/816x/https://il.beauty321.com/gallery/gallery/46868/photo-62344e7daca75.jpg',
          defaults: {
            toppings: [''],
            sugar: '',
            ice: '',
          }
        },
      ],
      // æš«å­˜æ‰€é¸
      temp: {
        name: 'é£²å“åç¨±',
        engName: 'drinks name',
        imageUrl: 'https://fakeimg.pl/85x85/?text=drinks',
      },
      // è¨‚å–®
      orderList: [],
      // ç¸½é‡‘é¡
      orderTotal: 0,
      // é»‘è‰²å€å¡Š
      darkZone: true,
      // é¡¯ç¤ºè¨‚å–®åˆ—è¡¨
      hasOrder: false,
      // è¨‚å–®æ˜ç´°
      orderDetail: [],
      historyOrder: [],
    }
  },
  methods: {
    // é¸æ“‡é£²å“
    selectDrinks(item) {
      // ç§»é™¤é»‘åº•
      this.darkZone = false;
      // é£²å“åç¨±
      this.temp.name = item.name;
      this.temp.engName = item.engName;
      this.temp.imageUrl = item.imageUrl;
      // é è¨­æ•¸é‡ç‚º1
      this.temp.number = 1;
      // åˆ¤æ–·æ˜¯å¦æœ‰å€¼ï¼Œæœ‰å€¼å°±å¡«å…¥ï¼Œç„¡å€¼å°±å¸¶å…¥é è¨­
      this.temp.ice = item.defaults.ice !== '' ? item.defaults.ice : 'æ­£å¸¸å†°';
      this.temp.sugar = item.defaults.sugar !== '' ? item.defaults.sugar : 'å…¨ç³–';
      this.temp.toppings = [];
      // é€™è£¡è™•ç†çš„ä¸å¤ªå¥½ï¼Œå°‡productè£¡çš„defaultå­˜å…¥tempä¸­ï¼Œæƒ³å•é‚„æœ‰å…¶ä»–è¾¦æ³•å—ï¼Ÿå¦å¤–ï¼Œç„¡æ³•ä½¿ç”¨this.temp.default.iceï¼ŒåŸå› ç‚ºä½•ï¼Ÿ
      this.temp.defaultIce = item.defaults.ice;
      this.temp.defaultSugar = item.defaults.sugar;
      this.temp.defaultToppings = item.defaults.toppings;
      this.temp.note = '';
      // é€™è£¡è™•ç†çš„ä¸å¤ªå¥½ï¼Œå°‡productè£¡çš„priceå­˜å…¥tempä¸­ï¼Œæƒ³å•é‚„æœ‰å…¶ä»–è¾¦æ³•å—ï¼Ÿ
      this.temp.price = item.price;
    },
    // å–æ¶ˆ
    cancelBtn() {
      // æ¸…ç©ºtemp
      this.temp = {
        name: 'é£²å“åç¨±',
        engName: 'drinks name',
        imageUrl: 'https://fakeimg.pl/85x85/?text=drinks',
      };
      // åŠ å›é»‘åº•
      this.darkZone = true;
    },
    // åŠ å…¥
    submitBtn(product) {
      // é¡¯ç¤ºè¨‚å–®åˆ—è¡¨
      this.hasOrder = true;

      // é€™æ˜¯æˆ‘çš„æƒ³æ³•ï¼Œä½†æˆ‘ç„¡æ³•å°‡ä¹‹åŠ ç¸½èµ·ä¾†ï¼Œåªæœƒä¸æ–·è¢«å–ä»£
      // this.orderList = [
      //   {
      //     name : product.name,
      //     note : product.note.join(' '),
      //     ice : product.ice,
      //     sugar : product.sugar,
      //     toppings : product.toppings.join('ã€'),
      //     price : product.price + product.toppings.length*10,
      //     number : product.number,
      //     sum : (product.price + product.toppings.length*10) * product.number, 
      //   }
      // ]
      
      // åˆ—å‡ºè¨‚å–®
      // æƒ³å•å•é€™è£¡æ˜¯å¦‚ä½•è§£é‡‹çš„ï¼Œæˆ‘ç†è§£çš„æ„æ€æ˜¯å°‡è¤‡è£½å‡ºä¾†çš„æ±è¥¿pushåˆ°orderListä¸­ï¼Œä½†é‚„æ˜¯ä¸ç†Ÿæ‚‰

      // ä¿®æ”¹è¨‚å–®åˆ—è¡¨
      if(product.id){
        this.orderList.forEach((item, i) => {
          if(item.id == product.id) {
            this.orderList[i] = product
            this.orderList[i].toppings = product.toppings,
            this.orderList[i].salesPrice = product.price + (product.toppings.length * 10),
            this.orderList[i].number = product.number == '' ? 1 : product.number,
            this.orderList[i].sum = (product.price + (product.toppings.length * 10)) * (product.number == '' ? 1 : product.number)
          }
        });
      }
      // åŠ å…¥è¨‚å–®åˆ—è¡¨
      else{
        this.orderList.unshift(Object.assign({}, {
          ...product,
          // è‹¥ç„¡æ•¸å€¼ï¼Œå‰‡é è¨­ç‚º1
          number: product.number == '' ? 1 : product.number,
          note: product.note,
          toppings: product.toppings,
          salesPrice: product.price + product.toppings.length*10,
          sum: (product.price + product.toppings.length*10) * (product.number == '' ? 1 : product.number),
          id: new Date().getTime(),
        }))
      }
      
      // è¨ˆç®—ç¸½é¡ï¼Œä¸çŸ¥é“æœ‰æ²’æœ‰æ›´å¥½çš„æ–¹å¼
      let count = 0
      this.orderList.forEach( item => {
        count += item.sum;
      });
      this.orderTotal = count;
      count = 0

      // æ¸…ç©ºtempã€åŠ å›é»‘åº•
      this.cancelBtn();
    },
    // åˆªé™¤
    deleteBtn(delItem) {
      // console.log(delItem);
      this.orderList = this.orderList.filter(item => item !== delItem);
      // ç¸½é¡æ‰£æ‰è¢«åˆªé™¤çš„
      this.orderTotal = this.orderTotal - delItem.sum;
      // åˆªé™¤æœ€å¾Œä¸€ç­†ï¼Œå‰‡éš±è—è¨‚å–®åˆ—è¡¨
      if(this.orderList == 0){
        this.hasOrder = false;
      }
      // æ¸…ç©ºtempã€åŠ å›é»‘åº•
      this.cancelBtn();
    },
    // ä¿®æ”¹
    modifyBtn(modifyItem) {
      this.darkZone = false;
      this.temp = {...modifyItem};

    },
    // åˆ—å‡ºæ˜ç´°
    generateOrder(orderList) {
      this.orderDetail.list = { ...orderList },
      this.orderDetail.date = new Date().toLocaleString(),
      this.orderDetail.length = Object.keys(this.orderDetail.list).length

      // è¨ˆç®—ç¸½é¡ï¼Œä¸çŸ¥é“æœ‰æ²’æœ‰æ›´å¥½çš„æ–¹å¼
      let count = 0
      Object.values(this.orderDetail.list).forEach( item => {
        count += item.sum;
      });
      this.orderTotal = count;
      count = 0
      this.orderDetail.total = this.orderTotal;
      orderTotal = 0;

      // å„²å­˜æ‰€æœ‰è³‡æ–™
      this.historyOrder.unshift(Object.assign({}, {
          ...this.orderDetail,
          setNumber: Object.keys(this.orderDetail.list).length,
      }))

      // æ¸…ç©ºè¨‚å–®
      this.orderList= [];
      // é—œé–‰è¨‚å–®åˆ—è¡¨
      this.hasOrder = false;
      // æ¸…ç©ºtempã€åŠ å›é»‘åº•
      this.cancelBtn();
    }
  },
};

Vue.createApp(App).mount('#app');
</script>
<!-- ğŸ™‡ğŸ™‡ç·´ç¿’çµæŸğŸ™‡ğŸ™‡ -->
</main>
  
    
    
  </div>
</div>


<footer class="footer py-2 bg-light">
  <div class="container text-center">
    <small class="text-black-50 fw-light mb-0">å…­è§’å­¸é™¢ Vue èª²ç¨‹å°ˆå±¬æ–‡ä»¶</small>
  </div>
</footer>
<link rel="stylesheet" href="./stylesheets//all.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
</body>
</html>
